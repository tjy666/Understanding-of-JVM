# 
$$
《深入理解 Java 虚拟机--JVM高级特性与最佳实践》
$$

```
  关于这本书已经断断续续的看了好几遍了，使自己对jvm有了很深的理解，但是由于长时间的不用，对很多的功能点有所遗忘，特此写下这篇随手记，为以后的回忆与学习提供帮助，第一次写这种笔记，有种无从下手的感觉，后续持续改进中。。。
```

![深入理解 Java 虚拟机](https://github.com/tjy666/Understanding-of-JVM/tree/master/picture/深入理解 Java 虚拟机.jpg)

### 1、关于java内存区域与内存溢出异常

​       下图为java运行时jvm将它所管理的内存划分的各个不同的数据区域，这些区域都有各自不同的用途，接下来，我会将这些区域的用途进行详细的介绍。

![java虚拟机运行时数据区](https://github.com/tjy666/Understanding-of-JVM/tree/master/picture/java虚拟机运行时数据区.jpg)

#### 1.1 程序计数器

​          程序计数器是一块较小的内存空间，它可以看做是当前线程所执行的字节码的行号指示器，字节码解释器就是通过它来确定java代码的执行顺序的，每一个线程都拥有独立的程序计数器，多线程是通过程序轮流切换处理器执行时间的方式来实现的，程序计数器可以保证每一个线程在切换后可以恢复到正确的执行位置。

#### 1.2 java虚拟机栈

​         许多coder将内存分为堆和栈，通过上图，我们知道，这种说法比较笼统，但是堆和栈确实占据了内存中大部分的空间，这个“栈”指的就是java虚拟机栈。

​        与程序计数器相同，java虚拟机也是线程所私有的，生命周期与线程相同，每个方法在执行的同时都会创建一个栈帧，用来存储局部变量表、操作数栈、动态链接、方法出口等信息。每一个方法从调用到执行完毕的过程就对应着一个栈帧在虚拟机栈中的入栈到出栈的过程。

![虚拟机栈用途](E:\git_repository\Understanding-of-JVM\picture\虚拟机栈用途.jpg) 

#### 1.3 本地方法栈

​         本地方法栈与java虚拟机栈作用相似，区别在与java虚拟机栈是为执行java方法而创建的栈，本地方法栈是为执行本地方法而创建的栈。

#### 1.4 java堆

​          java堆是在虚拟机启动的时候创建的，是被所有线程所共享的数据区域，它没有特殊的数据结构，只是内存的一块存储区域，占内存比例非常大，此区域的唯一目的就是存储创建的对象，java堆是垃圾收集器的主要管理区域，因此也被称为“GC堆”。

#### 1.5 方法区

​         与java堆相似，方法区也是被所有线程所共享的数据区域，它用于存储**已被**虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。

#### 1.6 其他注意点

​        直接内存：直接内存不是java数据区中的内存，在jdk4中的nio（New Input/Output）中，引入了一种根据堆中DirectByteBuffer对象的引用来对这块直接内存进行操作的机制，直接内存是native函数库直接分配的堆外内存，这样可以避免java堆与Native堆之间数据的来回复制，因此，在机器上给java分配内存时，要注意有直接内存的存在。
